"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.BlockhashCache = void 0;
class BlockhashCache {
    constructor(ttl = 60) {
        this.ttlSecs = ttl;
        this.blockhashes = [];
    }
    set(blockhash, ts) {
        this.blockhashes.push({ ts, blockhash });
        // Keep only N seconds of blockhashes
        let pops = 0;
        for (const item of this.blockhashes) {
            if (item.ts < ts - this.ttlSecs) {
                pops++;
            }
            else {
                break;
            }
        }
        for (let i = 0; i < pops; i++) {
            this.blockhashes.shift();
        }
    }
    get() {
        if (this.blockhashes.length > 0) {
            return this.blockhashes[0].blockhash;
        }
        else {
            throw new Error("No blockhash available");
        }
    }
}
exports.BlockhashCache = BlockhashCache;
