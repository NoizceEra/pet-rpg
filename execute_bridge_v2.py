from web3 import Web3
from eth_account import Account
import json

# Polygon RPC
RPC_URL = "https://polygon-rpc.com"
w3 = Web3(Web3.HTTPProvider(RPC_URL))

# Wallet
PRIVATE_KEY = "0x63d78fdcef72c7afe10aa7df9e1cf34ada39c4f152451ea2843dbf79bf0bc881"
account = Account.from_key(PRIVATE_KEY)

# LI.FI Bridge Data
TO_ADDRESS = "0x1231DEB6f5749EF6cE6943a275A1D3E7486F4EaE"
DATA = "0xa3443faa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000002403c0e40c4f598259c3c744e8f15d1ca6ab38e6392bad9b4e704800f99379336c2000000000000000000000000e5363dd6410e06ca5a2e2ab46854fd044e16612fb4a23d3b56ad6e2a72d61045bb6fa12985f1912a5dde2d4003ec465c94dcbbdc0000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003c499c542cef5e3811e1192ce70d8cc03d5c3359000000000000000000000000e5363dd6410e06ca5a2e2ab46854fd044e16612f00000000000000000000000000000000000000000000000000000000000f387c000000000000000000000000000000000000000000000000000000000000210500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f72656c61796465706f7369746f727900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008437962657250617900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000bd6c7b0d2f68c2b7805d88388319cfb6ecb50ea9000000000000000000000000bd6c7b0d2f68c2b7805d88388319cfb6ecb50ea90000000000000000000000003c499c542cef5e3811e1192ce70d8cc03d5c33590000000000000000000000003c499c542cef5e3811e1192ce70d8cc03d5c335900000000000000000000000000000000000000000000000000000000000f424000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000084eedd56e10000000000000000000000003c499c542cef5e3811e1192ce70d8cc03d5c33590000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009c4000000000000000000000000890cacd9dec1e1409c6598da18dc3d634e600b4500000000000000000000000000000000000000000000000000000000000000000000000000000000e5363dd6410e06ca5a2e2ab46854fd044e16612f000000000000000000000000e5363dd6410e06ca5a2e2ab46854fd044e16612f0000000000000000000000003c499c542cef5e3811e1192ce70d8cc03d5c3359000000000000000000000000833589fcd6edb6e08f4c7c32d4f71b54bda0291300000000000000000000000000000000000000000000000000000000000f0a3c0000000000000000000000000000000000000000000000000db68b4bc5f7689500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000698f407700000000000000000000000000000000000000000000000000000000698f64240000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001600000000000000000000000000000000000000000000000000000000000000000"

# Build bridge tx
nonce = w3.eth.get_transaction_count(account.address)
gas_price = w3.eth.gas_price

tx = {
    'from': account.address,
    'to': Web3.to_checksum_address(TO_ADDRESS),
    'data': DATA,
    'nonce': nonce,
    'gas': 600000,
    'gasPrice': int(gas_price * 1.5), # Add 50% buffer given the spikes
    'chainId': 137,
    'value': 0
}

# Sign and send
signed_tx = account.sign_transaction(tx)

try:
    tx_hash = w3.eth.send_raw_transaction(signed_tx.raw_transaction)
    print(f"Bridge TX Hash: {tx_hash.hex()}")
except Exception as e:
    print(f"Error: {e}")
